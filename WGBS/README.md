# A pipeline for RNA-seq and MeRIP-seq data analysis

For single-end sequencing, filenames of FASTQ files must always end with: ".fastq.gz".                           
For paired-end sequencing, the two FASTQ files of each sample are tagged by "R1" and "R2" respectively, so the filenames should always end with: ".R1.fastq.gz" or ".R2.fastq.gz". And other parts of them must be identical.                         

Put all your raw FASTQ fiels into one folder, such as folder name “1_rawFASTQ”.                  
You can run the scripts step by step or run one of them for a specific purpose.                 
Please run perl BS-Seq_N.pl -help to know it’s usage and what can the N-th script do.               



### BS-Seq_1.pl:                     
Check the quality of raw reads to identify possible experimental and sequencing errors or biases by using 4 tools: FastQC, fastp, FastQ_Screen, and MultiQC.       
### BS-Seq_2.pl:             
Remove adapters and bases with low quality by using Trimmomatic, and QC.   
### BS-Seq_3.pl:                        
Remove PCR duplicates with 100% identity by using clumpify.sh of BBMap and QC. (Optional)   

------------------------           

### BS-Seq_4_bwa-meth.A.pl:       
Mapping reads to the Lambda phage genome (spike-ins) by using bwa-meth.       
### BS-Seq_4_bwa-meth.B.pl:                     
Mapping reads to the human reference genome by using bwa-meth, and QC by FASTQC, SAMstat, qualimap, deepTools, PRESEQ, Picard, and MultiQC.
### BS-Seq_4A.pl:                 
To confirm the conversion rates of bisulfite sequencing,  we also mapped reads to the Lambda phage genome (spike-ins) by using Bismark.

-------------------------                

### BS-Seq_5.pl:               
Only the mapped reads with MAPQ>20 are retained. And only reads on chromosomes 1-22, X, and Y were ketp. Other reads are removed. And QC by FASTQC, SAMstat, qualimap, deepTools, PRESEQ, Picard, and MultiQC.          
### BS-Seq_6.pl:                   
Remove PCR duplicates using Picard and convert BAM to BAMPE format.               
### BS-Seq_7.pl:                        
Extracts the methylation call for every single C analysed by using bismark_methylation_extractor.                
### BS-Seq_8.pl:             
This script uses positional methylation data generated by the Bismark methylation extractor to generate a bedGraph file as well as a coverage file which are both sorted by chromosomal position.          
### BS-Seq_9.pl:           
Convert bedGraph to bigwig by using bedGraphToBigWig.                 
### BS-Seq_10.pl:                  
This script generates some figures for the correlation of number of covered C sites and reads.    

#### References:        
https://github.com/CTLife/2ndGS_Pipelines/tree/master/BSDA          
https://github.com/CTLife/PipiDABS          
https://www.nature.com/articles/s41586-022-05580-6                     
